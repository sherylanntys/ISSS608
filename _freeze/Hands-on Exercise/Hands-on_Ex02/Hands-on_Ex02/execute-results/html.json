{
  "hash": "95f94dfdcfa45ee3d3c3aeaad3894ab0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on Exercise 02: Beyond ggplot2 Fundamentals\"\nauthor: \"Sheryl Ann Tan Yi-Shi\"\ndate: \"2025-01-19\"\ndate-modified: \"last-modified\"\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n\n# 1.0 Getting Started\n\n## 1.1 Installing and Loading the Required Libraries\n\nThe following R packages will be used:\n\n-   *ggrepel*: Provides geoms for ggplot2 to repel overlapping text labels.\n\n-   *ggthemes*: Provides extra themes, geoms and scales for ggplot2.\n\n-   *hrbrthemes*: Provides typography-centric themes and theme components for ggplot2.\n\n-   *patchwork*: Prepares composite figure created using ggplot2.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse) \n```\n:::\n\n\n\n## 1.2 Importing Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv(\"data/Exam_data.csv\")\n```\n:::\n\n\n\n# 2.0 Beyond ggplot2 Annotation: `ggrepel`\n\nOne of the challenge in plotting statistical graph is annotation, especially with large number of data points.\n\n`geom_label()` helps to identify individual data points. However, this may result in overlapping text in large data sets.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label(aes(label = ID), \n             hjust = .5, \n             vjust = -.5) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\n`geom_label(aes(label = ID), hjust = .5, vjust = -.5)`: Adds labels using the ID column, slightly offset vertically and horizontally.\n:::\n\n## 2.1 Working with ***`ggrepel`***\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label_repel(aes(label = ID), \n                   fontface = \"bold\") +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\n`geom_label_repel(aes(label = ID), fontface = \"bold\")`: Replaces `geom_label()` to dynamically adjust label positions and prevent overlapping.\n\nThe density of points in certain regions of the graph may lead to labels being omitted.\n:::\n\n### 2.1.1 Exploring Other Arguments in *`geom_label_repel`*\n\nA list of arguments that can be used with `geom_label_repel()` can be found [here](https://www.rdocumentation.org/packages/ggrepel/versions/0.9.6/topics/geom_label_repel).\n\n**`max.overlaps`**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n       aes(x= MATHS, \n           y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  geom_label_repel(aes(label = ID), \n                   fontface = \"bold\",\n                   max.overlaps=20) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\n-   `max.overlaps`\\\n    By default, `geom_label_repel` exclude text labels when they overlap too many other labels. The default is 10. Increasing the `max.overlaps` argument would increase the number of labels displayed in the graph.\n:::\n\n# 3.0 Beyond *ggplot2* Themes\n\nggplot2 comes with eight built-in themes: `theme_gray()`, `theme_bw()`, `theme_classic()`, `theme_dark()`, `theme_light()`, `theme_linedraw()`, `theme_minimal()`, and `theme_void().`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  theme_gray() +\n  ggtitle(\"Distribution of Maths scores\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## 3.1 Working with *`ggtheme`* Package\n\nIn the example below, *The Economist* theme is used.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_economist()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## 3.2 Working with *`hrbthems`* Package\n\nThe `hrbrthemes` package provides a base theme that focuses on typographic elements, including where various labels are placed, and fonts that are used.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_ipsum()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  ggtitle(\"Distribution of Maths scores\") +\n  theme_ipsum(axis_title_size = 18,\n              base_size = 15,\n              grid = \"Y\")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\n-   `axis_title_size`: Adjust the font size of the axis title.\n\n-   `base_size`: Adjust the font size of the axis labels.\n\n-   `grid`: Remove the x-axis grid lines.\n:::\n\n# 4.0 Beyond a Single Graph\n\nMultiple graphs may be required for visual storytelling. We can create composite plots using `ggplot2` extensions.\n\nThe three statistical graphs are created separately using the respective code chunks below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of Maths scores\")\n\np1\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot(data=exam_data, \n             aes(x = ENGLISH)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of English scores\")\n\np2\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(data=exam_data, \n             aes(x= MATHS, \n                 y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n\np3\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## 4.1 Creating Composite Graphics: *`patchwork`* Methods\n\nGenerally syntax that can be used:\n\n-   `+`: Used to create a two-column layout\n\n-   `( )`: Used to create a subplot group.\n\n-   `/`: Used to create a two-row layout.\n\n### 4.1.1 Combining Two *`ggplot2`* Graphs\n\n::: panel-tabset\n#### Using +\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + p2\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n#### Using ()\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 + p2)/p1\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n#### Using /\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 / p3\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### 4.1.2 Combining Three *`ggplot2`* Graphs\n\nThe following syntax can be used:\n\n-   `/`: Used to stack two graphs.\n\n-   `|`: Used to place the plots beside each other.\n\n-   `( )`: Used to define the sequence of the plotting.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 / p2) | p3\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n### 4.1.3 Creating a Composite Figure with Tag\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1 / p2) | p3) + \n  plot_annotation(tag_levels = 'I')\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\n-   `plot_annotation()`: Adds annotations to the composite plot.\n\n-   `tag_levels = 'I'`: Automatically tags each subplot with Roman numerals. Other options for tag_levels include: `A`, `a`, `1`\n:::\n\n#### 4.1.3.1 Other Arguments for `plot_annotation()`\n\nA list of arguments that can be used with `plot_annotation()` can be found [here](https://www.rdocumentation.org/packages/patchwork/versions/0.0.1/topics/plot_annotation).\n\nUsing `tag_prefix:`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1 / p2) | p3) + \n  plot_annotation(tag_levels = '1', tag_prefix=\"Figure \")\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n### 4.1.4 Creating Figure with `inset`\n\n`inset_element()` of **patchwork** enables us to place several plots or graphic elements freely **on top or below another plot**.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 + inset_element(p2, \n                   left = 0.02, \n                   bottom = 0.7, \n                   right = 0.5, \n                   top = 1)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n### 4.1.5 Creating a Composite Figure by Using `patchwork` and `ggtheme`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npatchwork <- (p1 / p2) | p3\npatchwork & theme_economist()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n### 4.1.6 Attempting to Modify the Plot in 4.1.5\n\nAs the plot title of *p3* was cut off, with the titles of *p2* overlapping *p3*, we will attempt to modify the plot by reducing the title size. At the same time, I will also try other themes.\n\n::: panel-tabset\n#### Reducing the Title Size\n\nAdding `plot.title = element_text(size=10)` will reduce the respective plots' title size.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npatchwork & \n  theme_economist() & \n  theme(\n    plot.title = element_text(size = 9),        # Reduce plot title size\n    axis.text = element_text(size = 6),         # Reduce axis tick text size\n    axis.title = element_text(size = 6)         # Reduce axis labels size\n  )\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n#### Using `theme_wsj()`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npatchwork & \n  theme_wsj() & \n  theme(\n    plot.title = element_text(size = 8),        # Reduce plot title size\n    axis.text = element_text(size = 6),         # Reduce axis tick text size\n    axis.title = element_text(size = 6)         # Reduce axis labels size\n  )\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n:::\n\n# 5.0 References\n\n-   [Patchwork R package goes nerd viral](https://www.littlemissdata.com/blog/patchwork)\n\n-   [ggrepel](https://ggrepel.slowkow.com/)\n\n-   [ggthemes](https://ggplot2.tidyverse.org/reference/ggtheme.html)\n\n-   [hrbrthemes](https://cinc.rud.is/web/packages/hrbrthemes/)\n\n-   [ggplot tips: Arranging plots](https://albert-rapp.de/post/2021-10-28-extend-plot-variety/)\n\n-   [ggplot2 Theme Elements Demonstration](https://henrywang.nl/ggplot2-theme-elements-demonstration/)\n\n-   [ggplot2 Theme Elements Reference Sheet](https://isabella-b.com/blog/ggplot2-theme-elements-reference/)\n\n## 5.1 Disclaimer\n\nThis document includes content written with the assistance of ChatGPT, which was used for grammar correction and the explanation of arguments for the various packages.\n",
    "supporting": [
      "Hands-on_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}